test_run.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
test_run.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
Evaluation: smaller learning rate
Train graphs:8,Test graphs:8,hidden_nodes:0.2, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.5967,tot_acc=0.26353082191780824, F1_inf:0.14069835178014595
[1m 36s], Epoch: 100, Loss: 1.1415,tot_acc=0.804195205479452, F1_inf:0.35373546923731214
[3m 12s], Epoch: 200, Loss: 1.1263,tot_acc=0.7982910958904109, F1_inf:0.3431234946543987
[4m 47s], Epoch: 300, Loss: 1.1207,tot_acc=0.7971301369863014, F1_inf:0.33575858365381284
[6m 22s], Epoch: 400, Loss: 1.1170,tot_acc=0.7961301369863014, F1_inf:0.32959285178269143
Test_set:0, Test Accuracy: 0.7986,
 confusion_matrix:[[ 56833   9285    691      0      0]
 [   622   3963   2766     24      0]
 [   283   4927  10174   2133     53]
 [   133   3483  23945 162179   2674]
 [    16    137    999   6628     52]]
Accuracy_infected = 0.5790552077404667
Precision_infected = 0.2637459494491251
F1_score_infected = 0.3624187371983258
Test_set:1, Test Accuracy: 0.7070,
 confusion_matrix:[[ 26224  11096    302    268      2]
 [   526   5973   1194      7    121]
 [   359   8210   8750   1482   1157]
 [   120   5550  25425 164421  22369]
 [     2    195    922   6262   1063]]
Accuracy_infected = 0.43842068343521395
Precision_infected = 0.23911677096712486
F1_score_infected = 0.3094551820480628
Test_set:2, Test Accuracy: 0.7827,
 confusion_matrix:[[ 60745   8701    426      0      0]
 [   572   5130   1499      9     15]
 [   373   6870   8482   1088    113]
 [   115   4533  26946 154008   3883]
 [    23    304   1323   6659    183]]
Accuracy_infected = 0.5011225333805979
Precision_infected = 0.21930913227841556
F1_score_infected = 0.3050969389590303
Test_set:3, Test Accuracy: 0.7968,
 confusion_matrix:[[ 94510   6139    424     15      1]
 [   519   3663   1699      7     97]
 [   298   4345   8606   1548    832]
 [   125   2234  21143 125754  13548]
 [     0    134   1032   5187    140]]
Accuracy_infected = 0.550643035382942
Precision_infected = 0.2615487478725991
F1_score_infected = 0.35464529289349517
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.8, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6049,tot_acc=0.026513698630136986, F1_inf:nan
[1m 38s], Epoch: 100, Loss: 1.2588,tot_acc=0.7776215753424658, F1_inf:0.35781935677105786
[3m 14s], Epoch: 200, Loss: 1.2543,tot_acc=0.7763270547945206, F1_inf:0.3610795750089332
[4m 50s], Epoch: 300, Loss: 1.2518,tot_acc=0.7814503424657534, F1_inf:0.36194649320959094
[6m 25s], Epoch: 400, Loss: 1.2497,tot_acc=0.7653955479452055, F1_inf:0.36196422621737206
Test_set:0, Test Accuracy: 0.7306,
 confusion_matrix:[[231757  32770    806    265      0]
 [  2762  18865   5895     25     24]
 [  1543  25161  34970   6175   1485]
 [   459  13588  93183 565775 103269]
 [    44    547   3456  23166   2010]]
Accuracy_infected = 0.5043701502870165
Precision_infected = 0.25283782806738486
F1_score_infected = 0.3368264914950589
Test_set:1, Test Accuracy: 0.7041,
 confusion_matrix:[[115447  32999    848    476     41]
 [  3770  22027   5786     76     11]
 [  2124  28938  37875   6987   2150]
 [   923  17976  99255 642996 109936]
 [    67    839   4261  28095   4097]]
Accuracy_infected = 0.4851166841714271
Precision_infected = 0.25586894105725383
F1_score_infected = 0.335030230120434
Test_set:2, Test Accuracy: 0.7289,
 confusion_matrix:[[248730  29856    802     67     21]
 [  3120  19723   5367     67      2]
 [  1967  24776  34335   7026   1585]
 [   621  14779  92743 544662 108642]
 [    21    608   3720  20892   3868]]
Accuracy_infected = 0.4926889466056336
Precision_infected = 0.2506808209276687
F1_score_infected = 0.33229134406937133
Test_set:3, Test Accuracy: 0.7628,
 confusion_matrix:[[379401  23641    885     25      0]
 [  2708  15219   5129     24     41]
 [  1763  20379  30704   4701   2789]
 [   609  10366  75076 462878 104752]
 [     9    500   3208  20448   2745]]
Accuracy_infected = 0.5088835852559003
Precision_infected = 0.26698666110154606
F1_score_infected = 0.35022641982913005
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.9, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6086,tot_acc=0.6638789954337899, F1_inf:nan
[1m 36s], Epoch: 100, Loss: 1.2764,tot_acc=0.7010722983257229, F1_inf:0.36851079085705707
[3m 10s], Epoch: 200, Loss: 1.2735,tot_acc=0.6281963470319635, F1_inf:0.3643830993798277
[4m 44s], Epoch: 300, Loss: 1.2726,tot_acc=0.5935692541856925, F1_inf:0.3607256768551828
[6m 18s], Epoch: 400, Loss: 1.2716,tot_acc=0.587982496194825, F1_inf:0.3623187238805369
Test_set:0, Test Accuracy: 0.3978,
 confusion_matrix:[[251149  45481   1603      9    245]
 [  2061  20628   8387     26     48]
 [  1082  24621  43506   2465   6303]
 [   307  13100 111046 186385 563628]
 [    11    455   4192   6273  20989]]
Accuracy_infected = 0.557933749695423
Precision_infected = 0.25783778017471287
F1_score_infected = 0.3526879628391114
Test_set:1, Test Accuracy: 0.4208,
 confusion_matrix:[[120781  45238   1930    521     24]
 [  3328  22230  10203     28     20]
 [  2052  24792  52103   4124   4368]
 [   683  12904 132398 338581 495645]
 [    55    597   5695  16526  19174]]
Accuracy_infected = 0.5958782694221114
Precision_infected = 0.2575162235764522
F1_score_infected = 0.3596187294663317
Test_set:2, Test Accuracy: 0.4477,
 confusion_matrix:[[267135  45419   2045     49     42]
 [  2156  20136   9652     41     25]
 [  1294  21234  45857   4187   4994]
 [   414  10606 110946 236635 497644]
 [    20    441   4898   9635  18495]]
Accuracy_infected = 0.5911997524688652
Precision_infected = 0.2644609511067025
F1_score_infected = 0.36544683699654135
Test_set:3, Test Accuracy: 0.6109,
 confusion_matrix:[[424698  28075   1269      8     36]
 [  2608  16281   7233     70     13]
 [  1728  18790  39874   3892   2026]
 [   614   8517 102891 308984 315643]
 [     5    357   4504  12940  12944]]
Accuracy_infected = 0.6013270999849193
Precision_infected = 0.2559783271597409
F1_score_infected = 0.35909420436687517
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.95, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 3s], Epoch: 000, Loss: 1.6095,tot_acc=0.06055155010814708, F1_inf:0.1141887918639551
[1m 36s], Epoch: 100, Loss: 1.2853,tot_acc=0.6977591925018024, F1_inf:0.37050966203698193
[3m 10s], Epoch: 200, Loss: 1.2808,tot_acc=0.7938262436914203, F1_inf:0.36051475592402404
[4m 44s], Epoch: 300, Loss: 1.2795,tot_acc=0.702998558038933, F1_inf:0.3597450436974075
[6m 18s], Epoch: 400, Loss: 1.2792,tot_acc=0.6734592645998558, F1_inf:0.3558997050147492
Test_set:0, Test Accuracy: 0.5077,
 confusion_matrix:[[276258  37451   1207     22    257]
 [  3882  21006   7882    125     15]
 [  2330  26852  43095   7417   2681]
 [   703  14255 112826 346772 445319]
 [    57    653   4488  14372  17075]]
Accuracy_infected = 0.5231562974203339
Precision_infected = 0.25425078761991293
F1_score_infected = 0.34219626557828753
Test_set:1, Test Accuracy: 0.5578,
 confusion_matrix:[[132650  42704   2011    735     28]
 [  4220  23089  10380    151     38]
 [  2644  26183  51154   7907   4641]
 [  1098  13952 122394 549165 350011]
 [    69    598   4669  18900  17609]]
Accuracy_infected = 0.552842892498568
Precision_infected = 0.2683727860320658
F1_score_infected = 0.3613374444173668
Test_set:2, Test Accuracy: 0.6010,
 confusion_matrix:[[289151  41367   1603    113      2]
 [  3168  22365   7794    125     13]
 [  2082  26678  42071   8208   3747]
 [   598  14892 105522 466495 316142]
 [    28    644   4066  16606  13520]]
Accuracy_infected = 0.5081897905442949
Precision_infected = 0.2612196999801311
F1_score_infected = 0.3450677077779874
Test_set:3, Test Accuracy: 0.6009,
 confusion_matrix:[[447299  30798   1459     28      0]
 [  2742  16947   7965    112     37]
 [  1884  19206  40830   6988   1932]
 [   702   8394  92823 312779 361825]
 [    13    375   4207  12018  15637]]
Accuracy_infected = 0.5763692828910221
Precision_infected = 0.2772195214687271
F1_score_infected = 0.37437420916542885
#####################################################################
