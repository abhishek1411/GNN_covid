gnn_seird_cluster.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
gnn_seird_cluster.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
gnn_seird_cluster.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
gnn_seird_cluster.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
Evaluation: SAGECOonv and various hidden masks
Train graphs:8,Test graphs:8,hidden_nodes:0.2, k_days:15
location of graphs:./graphs, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): SAGEConv(5, 32)
  (conv2): SAGEConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6013,tot_acc=0.3492191780821918, F1_inf:nan
[1m 2s], Epoch: 100, Loss: 0.9965,tot_acc=0.6847260273972603, F1_inf:0.35327397514375813
[2m 4s], Epoch: 200, Loss: 0.9863,tot_acc=0.6803184931506849, F1_inf:0.34689275728330476
[3m 5s], Epoch: 300, Loss: 0.9825,tot_acc=0.6764589041095891, F1_inf:0.35098235098235103
[4m 7s], Epoch: 400, Loss: 0.9802,tot_acc=0.6670719178082192, F1_inf:0.35303276029841063
[5m 8s], Epoch: 500, Loss: 0.9792,tot_acc=0.6626643835616438, F1_inf:0.3504826702600013
[6m 10s], Epoch: 600, Loss: 0.9784,tot_acc=0.6631335616438356, F1_inf:0.3579759899353903
Test_set:0, Test Accuracy: 0.6633,
 confusion_matrix:[[93961  7783   338     0     0]
 [  387  3988  1369     0     0]
 [  158  4376  8347   885   538]
 [   52  2206 21786 85329 54866]
 [    0    81   626  2861  2063]]
Accuracy_infected = 0.5835430648769575
Precision_infected = 0.25709973510749706
F1_score_infected = 0.35693820825315375
Test_set:1, Test Accuracy: 0.5506,
 confusion_matrix:[[ 23665   9956    361      0    261]
 [   575   5431   2060      0      0]
 [   498   6243  11087    972    767]
 [   120   3176  29043 118971  71828]
 [    12    168    881   4292   1633]]
Accuracy_infected = 0.566617263760413
Precision_infected = 0.2552726100571008
F1_score_infected = 0.3519738408546168
Test_set:2, Test Accuracy: 0.5404,
 confusion_matrix:[[ 24666   9621    387      3    239]
 [   630   5262   1812     21      0]
 [   503   6253  12001   1171   1628]
 [   188   3170  27492 112362  75206]
 [    23    146    895   4803   3518]]
Accuracy_infected = 0.556735943588792
Precision_infected = 0.2817996102096884
F1_score_infected = 0.37419515769452627
Test_set:3, Test Accuracy: 0.5623,
 confusion_matrix:[[ 24101   9054    616     10     10]
 [   750   5084   1949     14      6]
 [   517   5555  12111   1290    863]
 [   175   2944  28506 118547  70819]
 [     0     65   1253   3405   4356]]
Accuracy_infected = 0.5955448465774981
Precision_infected = 0.2725554180263306
F1_score_infected = 0.37396365657470165
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.8, k_days:15
location of graphs:./graphs, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): SAGEConv(5, 32)
  (conv2): SAGEConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6079,tot_acc=0.34890325342465756, F1_inf:nan
[1m 3s], Epoch: 100, Loss: 1.2122,tot_acc=0.5017020547945206, F1_inf:0.3456332971293832
[2m 5s], Epoch: 200, Loss: 1.2042,tot_acc=0.5166472602739726, F1_inf:0.3535877726434078
[3m 7s], Epoch: 300, Loss: 1.2009,tot_acc=0.5546832191780822, F1_inf:0.3555096671051974
[4m 9s], Epoch: 400, Loss: 1.1982,tot_acc=0.6024991438356164, F1_inf:0.3522356351726656
[5m 11s], Epoch: 500, Loss: 1.1955,tot_acc=0.6115042808219178, F1_inf:0.35411342489544
[6m 13s], Epoch: 600, Loss: 1.1931,tot_acc=0.6198578767123287, F1_inf:0.3544989600172135
Test_set:0, Test Accuracy: 0.6432,
 confusion_matrix:[[368948  36630    954    235     54]
 [  1591  17225   5282      9     46]
 [   924  19906  31009   3148   3686]
 [   284  10863  76133 322869 239009]
 [     0    466   3415  14153  11161]]
Accuracy_infected = 0.5285054454348679
Precision_infected = 0.2655039257489747
F1_score_infected = 0.35344739151744503
Test_set:1, Test Accuracy: 0.4895,
 confusion_matrix:[[ 89928  45007    997      0    271]
 [  2362  22139   7713     10     52]
 [  1542  25212  43661   3772   6127]
 [   369  12715 109410 401454 359785]
 [    16    593   4395  15935  14535]]
Accuracy_infected = 0.5436287571282715
Precision_infected = 0.2627395051030233
F1_score_infected = 0.3542618361799667
Test_set:2, Test Accuracy: 0.4736,
 confusion_matrix:[[100441  37454   1354    246     12]
 [  3213  21250   7319     40     98]
 [  2057  25860  42806   3327   6539]
 [   644  13678 113693 375096 379347]
 [    28    469   3895  15590  13544]]
Accuracy_infected = 0.5311643028204842
Precision_infected = 0.2531895639007021
F1_score_infected = 0.34291985772422856
Test_set:3, Test Accuracy: 0.4944,
 confusion_matrix:[[ 92469  41186   1396    492     43]
 [  2344  21189   7434      2     82]
 [  1570  24877  44859   2497   5490]
 [   453  12661 114119 405230 355662]
 [    45    631   4639  14891  13739]]
Accuracy_infected = 0.5657372025273353
Precision_infected = 0.26013209855781777
F1_score_infected = 0.3563915150552157
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.9, k_days:15
location of graphs:./graphs, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): SAGEConv(5, 32)
  (conv2): SAGEConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6091,tot_acc=0.34848401826484016, F1_inf:nan
[1m 4s], Epoch: 100, Loss: 1.2476,tot_acc=0.5264581430745814, F1_inf:0.3580239650134337
[2m 6s], Epoch: 200, Loss: 1.2410,tot_acc=0.5906293759512937, F1_inf:0.3576451372435438
[3m 8s], Epoch: 300, Loss: 1.2371,tot_acc=0.6225608828006088, F1_inf:0.35906995088694604
[4m 11s], Epoch: 400, Loss: 1.2330,tot_acc=0.6231742770167428, F1_inf:0.3598094729594919
[5m 13s], Epoch: 500, Loss: 1.2308,tot_acc=0.6150205479452054, F1_inf:0.3566361950248005
[6m 15s], Epoch: 600, Loss: 1.2285,tot_acc=0.6297039573820395, F1_inf:0.3582382552688283
Test_set:0, Test Accuracy: 0.6084,
 confusion_matrix:[[423416  32296   1265    448     19]
 [  2633  17843   6864      0      4]
 [  1493  20616  38346   2124   2817]
 [   531  11281 116037 306882 296100]
 [     4    445   5194  14331  13011]]
Accuracy_infected = 0.5863661386017494
Precision_infected = 0.22865013774104684
F1_score_infected = 0.3290061861331091
Test_set:1, Test Accuracy: 0.4930,
 confusion_matrix:[[ 99836  51836   1213    262    246]
 [  2534  25418   7837      1     16]
 [  1644  30172  50293   3458   4222]
 [   420  15583 155650 461107 362098]
 [    20    690   6626  21731  11087]]
Accuracy_infected = 0.5601242913942688
Precision_infected = 0.22693451373754056
F1_score_infected = 0.3230039048450907
Test_set:2, Test Accuracy: 0.4871,
 confusion_matrix:[[105082  50518   2139    458      0]
 [  2572  23979   8951     31     28]
 [  1727  28232  53303   3105   4588]
 [   597  13606 163420 442437 369771]
 [    14    462   6157  17547  15276]]
Accuracy_infected = 0.586037051289099
Precision_infected = 0.2278198059580288
F1_score_infected = 0.3280941755789798
Test_set:3, Test Accuracy: 0.4902,
 confusion_matrix:[[102870  47728   1946    250    491]
 [  2435  23549   8866     35     16]
 [  1686  27154  54178   2752   4036]
 [   519  13157 153452 449110 379983]
 [    51    680   6257  18378  14421]]
Accuracy_infected = 0.6032781774046277
Precision_infected = 0.2411136676175684
F1_score_infected = 0.34452870383618706
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.95, k_days:15
location of graphs:./graphs, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): SAGEConv(5, 32)
  (conv2): SAGEConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6096,tot_acc=0.3483972602739726, F1_inf:nan
[1m 4s], Epoch: 100, Loss: 1.2675,tot_acc=0.7460908435472242, F1_inf:0.35837743553150586
[2m 6s], Epoch: 200, Loss: 1.2625,tot_acc=0.6903864455659697, F1_inf:0.3540229656904098
[3m 8s], Epoch: 300, Loss: 1.2601,tot_acc=0.6823561643835616, F1_inf:0.35234151314281253
[4m 10s], Epoch: 400, Loss: 1.2585,tot_acc=0.6867779379956741, F1_inf:0.3510423671822462
[5m 12s], Epoch: 500, Loss: 1.2572,tot_acc=0.6758644556596972, F1_inf:0.35018511118707063
[6m 14s], Epoch: 600, Loss: 1.2564,tot_acc=0.6842198990627253, F1_inf:0.34980871490098886
Test_set:0, Test Accuracy: 0.6074,
 confusion_matrix:[[428166  53128   1618    481     68]
 [  2277  19222   7264      4     66]
 [  1362  21977  38630   1928   5420]
 [   599  12847  99834 342778 311992]
 [     3    548   5028  18083  13677]]
Accuracy_infected = 0.5572947473202822
Precision_infected = 0.25352094189297386
F1_score_infected = 0.3485030966525479
Test_set:1, Test Accuracy: 0.4873,
 confusion_matrix:[[ 91611  68758    966    449     65]
 [  2365  28457   7097     22     71]
 [  1690  34998  46703   4029   7152]
 [   485  19861 139804 493907 396380]
 [    18    905   5690  20338  15179]]
Accuracy_infected = 0.4938353846804551
Precision_infected = 0.23321182462798362
F1_score_infected = 0.31681092961415314
Test_set:2, Test Accuracy: 0.5757,
 confusion_matrix:[[104112  60549   2062    544     28]
 [  2686  26311   8073    141    313]
 [  1652  34040  45051   7539   7834]
 [   627  19026 120948 612057 293376]
 [     2    604   4357  24054  11014]]
Accuracy_infected = 0.46871488617920015
Precision_infected = 0.24960247325351403
F1_score_infected = 0.3257401294978074
Test_set:3, Test Accuracy: 0.4541,
 confusion_matrix:[[107936  51497   1295    209    557]
 [  2775  27058   6857     15    110]
 [  2070  36069  45917   2114   8758]
 [   546  19841 123106 429248 477192]
 [    56   1019   5433  17677  19645]]
Accuracy_infected = 0.48370343839541546
Precision_infected = 0.25145119600455623
F1_score_infected = 0.33089040701026173
#####################################################################
