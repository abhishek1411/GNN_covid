gnn_seird_cluster.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
gnn_seird_cluster.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
gnn_seird_cluster.py:290: RuntimeWarning: invalid value encountered in long_scalars
  infected_precision = conf_matrix[2,2]/np.sum(conf_matrix[:,2])
Evaluation: sane topology
Train graphs:8,Test graphs:8,hidden_nodes:0.2, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6011,tot_acc=0.7732157534246575, F1_inf:0.26145503714958807
[1m 35s], Epoch: 100, Loss: 1.1453,tot_acc=0.802958904109589, F1_inf:0.3520418071714836
[3m 9s], Epoch: 200, Loss: 1.1309,tot_acc=0.797945205479452, F1_inf:0.33648579630510206
[4m 43s], Epoch: 300, Loss: 1.1229,tot_acc=0.7964520547945205, F1_inf:0.32833368295923365
[6m 17s], Epoch: 400, Loss: 1.1194,tot_acc=0.7965616438356165, F1_inf:0.3298044328552803
[7m 51s], Epoch: 500, Loss: 1.1174,tot_acc=0.7967328767123287, F1_inf:0.318052913091862
[9m 25s], Epoch: 600, Loss: 1.1149,tot_acc=0.7965719178082192, F1_inf:0.3235127277884138
Test_set:0, Test Accuracy: 0.7940,
 confusion_matrix:[[ 56686   9592    531      0      0]
 [   610   4319   2440      6      0]
 [   268   5708   9518   2045     31]
 [   127   4135  24114 161317   2721]
 [    16    161    987   6646     22]]
Accuracy_infected = 0.5417188389299943
Precision_infected = 0.25320563979781857
F1_score_infected = 0.34510514865844816
Test_set:1, Test Accuracy: 0.7016,
 confusion_matrix:[[ 25959  11423    241    264      5]
 [   495   6208   1030      7     81]
 [   351   8661   8479   1506    961]
 [    99   5994  25797 163396  22599]
 [     1    213    952   6457    821]]
Accuracy_infected = 0.42484216855396334
Precision_infected = 0.23230773445847833
F1_score_infected = 0.3003701932444161
Test_set:2, Test Accuracy: 0.7825,
 confusion_matrix:[[ 60645   8950    277      0      0]
 [   569   5389   1244      8     15]
 [   375   7416   8008   1070     57]
 [   113   4987  26698 154271   3416]
 [    23    334   1303   6652    180]]
Accuracy_infected = 0.4731182795698925
Precision_infected = 0.2133759658939515
F1_score_infected = 0.294109005435581
Test_set:3, Test Accuracy: 0.7970,
 confusion_matrix:[[ 94452   6296    325     16      0]
 [   506   3926   1478      4     71]
 [   290   4907   8194   1506    732]
 [   125   2585  21173 125868  13053]
 [     0    155   1018   5029    291]]
Accuracy_infected = 0.524281783863331
Precision_infected = 0.25456691934882564
F1_score_infected = 0.3427232992450383
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.8, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6067,tot_acc=0.8694503424657535, F1_inf:nan
[1m 37s], Epoch: 100, Loss: 1.2623,tot_acc=0.7580693493150685, F1_inf:0.3546377021307383
[3m 11s], Epoch: 200, Loss: 1.2559,tot_acc=0.7932756849315068, F1_inf:0.35988819326332494
[4m 46s], Epoch: 300, Loss: 1.2532,tot_acc=0.7858595890410959, F1_inf:0.3614806695439702
[6m 21s], Epoch: 400, Loss: 1.2510,tot_acc=0.7763219178082191, F1_inf:0.3616587107823489
[7m 56s], Epoch: 500, Loss: 1.2495,tot_acc=0.7800368150684932, F1_inf:0.3617766158740025
[9m 31s], Epoch: 600, Loss: 1.2485,tot_acc=0.7779109589041096, F1_inf:0.36232769430753897
Test_set:0, Test Accuracy: 0.7330,
 confusion_matrix:[[231023  33366    936    267      6]
 [  2689  18569   6244     30     39]
 [  1499  24444  35512   6195   1684]
 [   449  13250  92024 569295 101256]
 [    44    528   3425  23423   1803]]
Accuracy_infected = 0.5121873828136267
Precision_infected = 0.2570706741662504
F1_score_infected = 0.3423255813953488
Test_set:1, Test Accuracy: 0.7144,
 confusion_matrix:[[114755  33623    910    503     20]
 [  3682  21872   6012     78     26]
 [  2054  28574  37862   7241   2343]
 [   899  17850  96531 655984  99822]
 [    64    843   4190  28290   3972]]
Accuracy_infected = 0.48495017547454977
Precision_infected = 0.260210989313082
F1_score_infected = 0.3386901274269945
Test_set:2, Test Accuracy: 0.7233,
 confusion_matrix:[[247974  30540    874     76     12]
 [  3008  19554   5650     67      0]
 [  1869  24350  34484   7216   1770]
 [   593  14474  89846 539204 117330]
 [    19    606   3645  21232   3607]]
Accuracy_infected = 0.4948270171763119
Precision_infected = 0.256388523334746
F1_score_infected = 0.3377671557584187
Test_set:3, Test Accuracy: 0.7726,
 confusion_matrix:[[379066  23927    933     26      0]
 [  2685  15091   5278     22     45]
 [  1736  20224  30566   4930   2880]
 [   613  10286  72216 474874  95692]
 [     8    502   3101  20482   2817]]
Accuracy_infected = 0.5065963935295678
Precision_infected = 0.27268185629917746
F1_score_infected = 0.3545322739662472
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.9, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6078,tot_acc=0.8658797564687976, F1_inf:nan
[1m 37s], Epoch: 100, Loss: 1.2787,tot_acc=0.6774444444444444, F1_inf:0.36523763433682666
[3m 12s], Epoch: 200, Loss: 1.2734,tot_acc=0.5833713850837139, F1_inf:0.36160639071636674
[4m 47s], Epoch: 300, Loss: 1.2724,tot_acc=0.5683744292237443, F1_inf:0.3617321281572706
[6m 22s], Epoch: 400, Loss: 1.2709,tot_acc=0.5270776255707763, F1_inf:0.36179791866558414
[7m 56s], Epoch: 500, Loss: 1.2696,tot_acc=0.4919764079147641, F1_inf:0.3626796871497451
[9m 31s], Epoch: 600, Loss: 1.2683,tot_acc=0.4649718417047184, F1_inf:0.36306657309488666
Test_set:0, Test Accuracy: 0.3196,
 confusion_matrix:[[251560  45163   1509    255      0]
 [  2073  20778   8219     41     39]
 [  1099  24942  43031   1986   6919]
 [   311  13299 109556  81352 669948]
 [    11    470   4140   4000  23299]]
Accuracy_infected = 0.5518422098824012
Precision_infected = 0.2585143131777357
F1_score_infected = 0.35208974275054
Test_set:1, Test Accuracy: 0.3395,
 confusion_matrix:[[121095  45015   1834    525     25]
 [  3367  22343  10045     42     12]
 [  2072  25004  51623   4376   4364]
 [   687  13111 129904 225775 610734]
 [    56    611   5568  10601  25211]]
Accuracy_infected = 0.5903887281419047
Precision_infected = 0.25944595776332585
F1_score_infected = 0.36047944751111155
Test_set:2, Test Accuracy: 0.4003,
 confusion_matrix:[[267106  45478   2013     52     41]
 [  2148  20189   9595     32     46]
 [  1282  21290  45626   4183   5185]
 [   410  10567 109821 171704 563743]
 [    21    439   4785   6940  21304]]
Accuracy_infected = 0.588221643503597
Precision_infected = 0.26551443202979513
F1_score_infected = 0.3658773245230668
Test_set:3, Test Accuracy: 0.5339,
 confusion_matrix:[[424864  27954   1225     43      0]
 [  2624  16361   7132     74     14]
 [  1738  18952  39584   4040   1996]
 [   613   8577 101367 204336 421756]
 [     6    364   4447   9566  16367]]
Accuracy_infected = 0.5969537023073443
Precision_infected = 0.2574485382589184
F1_score_infected = 0.3597482561970327
#####################################################################
Train graphs:8,Test graphs:8,hidden_nodes:0.95, k_days:15
location of graphs:./graphs_same_topo, weight_scale= 1.0, dropout= 0.3
No.of_days_used:365
GCN(
  (conv1): GCNConv(5, 32)
  (conv2): GCNConv(32, 32)
  (out): Linear(in_features=32, out_features=5, bias=True)
)
[0m 2s], Epoch: 000, Loss: 1.6084,tot_acc=0.7909084354722422, F1_inf:nan
[1m 37s], Epoch: 100, Loss: 1.2861,tot_acc=0.7019920692141313, F1_inf:0.3665605095541401
[3m 11s], Epoch: 200, Loss: 1.2821,tot_acc=0.7365508291276136, F1_inf:0.3634241978956302
[4m 46s], Epoch: 300, Loss: 1.2805,tot_acc=0.6903648161499639, F1_inf:0.3629701888559388
[6m 20s], Epoch: 400, Loss: 1.2801,tot_acc=0.6643431867339582, F1_inf:0.35767063147292427
[7m 55s], Epoch: 500, Loss: 1.2793,tot_acc=0.6231672674837779, F1_inf:0.358219283407658
[9m 29s], Epoch: 600, Loss: 1.2791,tot_acc=0.634536409516943, F1_inf:0.3592542239715924
Test_set:0, Test Accuracy: 0.5965,
 confusion_matrix:[[275150  38408   1357     29    251]
 [  3690  20906   8178    100     36]
 [  2196  26605  43503   7950   2121]
 [   665  14384 112163 475376 317287]
 [    57    668   4428  19118  12374]]
Accuracy_infected = 0.5281092564491654
Precision_infected = 0.2564596855490512
F1_score_infected = 0.3452564245011984
Test_set:1, Test Accuracy: 0.6180,
 confusion_matrix:[[130524  44599   2240    742     23]
 [  3976  22892  10806    148     56]
 [  2475  25451  51278   8562   4763]
 [  1025  13510 115056 640276 266753]
 [    66    594   4528  24484  12173]]
Accuracy_infected = 0.5541830128932551
Precision_infected = 0.2788241947060487
F1_score_infected = 0.37099230566096436
Test_set:2, Test Accuracy: 0.6548,
 confusion_matrix:[[287462  43021   1641    110      2]
 [  3029  22384   7909    104     39]
 [  1969  26767  41861   8796   3393]
 [   547  14887 103533 546419 238263]
 [    23    676   3938  20182  10045]]
Accuracy_infected = 0.505653129756239
Precision_infected = 0.2634722624337559
F1_score_infected = 0.3464339507092375
Test_set:3, Test Accuracy: 0.6700,
 confusion_matrix:[[446190  31713   1652      3     26]
 [  2631  16695   8322     98     57]
 [  1814  18608  41490   6802   2126]
 [   687   8076  93512 413090 261158]
 [    13    370   4216  15764  11887]]
Accuracy_infected = 0.5856860530773574
Precision_infected = 0.2780980213416269
F1_score_infected = 0.3771269633507853
#####################################################################
